<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>KIX-SAML2SP</Name>
    <Version>0.0.1</Version>
    <Vendor>Restena.lu</Vendor>
    <URL>https://github.com/MBP3D/kix-saml-test/</URL>
    <Description Lang="en">SAML2 Service Provider for Customer authentication.</Description>
    <Framework>17.2.0-0</Framework>
    <BuildDate>2016-12-06 09:01:14</BuildDate>
    <BuildHost>ubuntu</BuildHost>
    <Filelist>
        <File Location="Kernel/System/CustomerAuth/SAML2SP.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQLnBtIC0gYXV0aGVudGljYXRpb24gbW9kdWxlCiMgQ29weXJpZ2h0IChDKSAoMjAxNikgKE1heGltZSBBcHBvbG9uaWEpIChtYXhpbWUuYXBwb2xvbmlhQHJlc3RlbmEubHUpCiMgaHR0cHM6Ly9naXRodWIuY29tL3Jlc3RlbmEtbWEvb3Rycy1zYW1sMnNwCiMgLS0KIyBUaGlzIHNvZnR3YXJlIGNvbWVzIHdpdGggQUJTT0xVVEVMWSBOTyBXQVJSQU5UWS4gRm9yIGRldGFpbHMsIHNlZQojIHRoZSBlbmNsb3NlZCBmaWxlIENPUFlJTkcgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24gKEFHUEwpLiBJZiB5b3UKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2FncGwudHh0LgojIC0tCiMgTm90ZToKIwojICBJbiBvcmRlciB0byBkaXNwbGF5IGEgIkxvZ2luIHZpYSBTQU1MIiBidXR0b24geW91IGhhdmUgdG8gaW5jbHVkZSB0aGUgaHRtbCBjb2RlIGJlbG93IGludG8gdGhlIExvZ2luLnR0IHRlbXBsYXRlIGZpbGUgbmVhciB0aGUgbG9naW4gZm9ybQojCiMgIDwhLS0gQWRkIHRoZSBzc28gbG9naW4gYnV0dG9uIC0tPgojICA8ZGl2IGNsYXNzPSJDb250ZW50IiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyBkaXNwbGF5OiBibG9jazsgaGVpZ2h0OiA0MHB4OyBwYWRkaW5nLXRvcDogMjBweDsgcGFkZGluZy1ib3R0b206IDA7IHZlcnRpY2FsLWFsaWduOiBib3R0b207IGxpbmUtaGVpZ2h0OiA0MHB4OyI+CiMgICAgPGEgaHJlZj0iLi9pbmRleC5wbD9BY3Rpb249TG9naW4mV2FudFNBTUxSZXF1ZXN0PXRydWUiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZTllOWU5OyBib3JkZXItcmFkaXVzOiA1cHg7IHBhZGRpbmc6IDEwcHg7Ym9yZGVyOiAxcHggc29saWQgI2NjYzsgZm9udC13ZWlnaHQ6IGJvbGQ7IiA+TG9naW4gdmlhIFNBTUwyIFNTTzwvYT4KIyAgPC9kaXY+CiMgIDwhLS0gZW5kIHNzbyBsb2dpbiBidXR0b24gLS0+CiMKIwojICBJbiB0aGUgRGVmYXVsdC5wbSB5b3UgY2FuIGFjdGl2ZSB0aGlzIGF1dGggbW9kdWxlIHdpdGggYSBmYWxsYmFjayBvbiB0aGUgZGVmYXVsdCBEQiBtb2R1bGUKIyAgCiMgICRTZWxmLT57QXV0aE1vZHVsZTF9ID0gJ0tlcm5lbDo6U3lzdGVtOjpBdXRoOjpEQic7CiMgICRTZWxmLT57QXV0aE1vZHVsZX0gPSAnS2VybmVsOjpTeXN0ZW06OkF1dGg6OlNBTUwyU1AnOwojICAkU2VsZi0+eydBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09JZHBVcmwnfSA9ICdodHRwczovL2lkcC5leGFtcGxlLmNvbS9zaW1wbGVzYW1sL3NhbWwyL2lkcC9TU09TZXJ2aWNlLnBocCc7CiMgICRTZWxmLT57J0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMJ30gPSAnL290cnMvaW5kZXgucGw/QWN0aW9uPUxvZ2luJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPVXNlcklkQXR0cmlidXRlJ30gPSAnVXNlcklkJzsKIyAgJFNlbGYtPnsnQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnQnfSA9ICItLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS14eHh4eHh4LS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLSI7CiMKIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXI6OkF1dGhNb2R1bGU6OlNBTUwyU1A7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7CgpvdXIgQE9iamVjdERlcGVuZGVuY2llcyA9ICgKICAgICdLZXJuZWw6OkNvbmZpZycsCiAgICAnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OkxvZycKKTsKCgp1c2UgQ0dJOwojdXNlIEZpbmRCaW4gcXcoJEJpbik7CiN1c2UgbGliICIkQmluLy4uLyI7CnVzZSBLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXI6OkF1dGhNb2R1bGU6OlNBTUwyU1A6OkNvbmZpZzsKdXNlIEtlcm5lbDo6U3lzdGVtOjpDdXN0b21lcjo6QXV0aE1vZHVsZTo6U0FNTDJTUDo6QXV0aFJlcXVlc3Q7CnVzZSBLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXI6OkF1dGhNb2R1bGU6OlNBTUwyU1A6OlJlc3BvbnNlOwoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICAjIERlYnVnIDA9b2ZmIDE9b24KICAgICRTZWxmLT57RGVidWd9ID0gMDsKCiAgICAjIGdldCBjb25maWcgb2JqZWN0CiAgICBteSAkQ29uZmlnT2JqZWN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKTsKCgogICAgIyBnZXQgY29uZmlnCiAgICAkU2VsZi0+e1NTT0lkcFVybH0gPSAkQ29uZmlnT2JqZWN0LT5HZXQoICdBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09JZHBVcmwnIC4gJFBhcmFte0NvdW50fSApIHx8IGRpZSAiTmVlZCBBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09JZHBVcmx7Q291bnR9IGluIEtlcm5lbC9Db25maWcucG0iOwogICAgJFNlbGYtPntTU09Bc3NlcnRpb25Db25zdW1lclVSTH0gPSAkQ29uZmlnT2JqZWN0LT5HZXQoICdBdXRoTW9kdWxlOjpTQU1MMlNQOjpTU09Bc3NlcnRpb25Db25zdW1lclVSTCcgLiAkUGFyYW17Q291bnR9ICkgfHwgZGllICJOZWVkIEF1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT0Fzc2VydGlvbkNvbnN1bWVyVVJMe0NvdW50fSBpbiBLZXJuZWwvQ29uZmlnLnBtIjsKICAgICRTZWxmLT57U1NPVXNlcklkQXR0cmlidXRlfSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT1VzZXJJZEF0dHJpYnV0ZScgLiAkUGFyYW17Q291bnR9ICkgfHwgZGllICJOZWVkIEF1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT1VzZXJJZEF0dHJpYnV0ZXtDb3VudH0gaW4gS2VybmVsL0NvbmZpZy5wbSI7CiAgICAkU2VsZi0+e1NTT3g1MDlDZXJ0fSA9ICRDb25maWdPYmplY3QtPkdldCggJ0F1dGhNb2R1bGU6OlNBTUwyU1A6OlNTT3g1MDlDZXJ0JyAuICRQYXJhbXtDb3VudH0gKSB8fCBkaWUgIk5lZWQgQXV0aE1vZHVsZTo6U0FNTDJTUDo6U1NPeDUwOUNlcnR7Q291bnR9IGluIEtlcm5lbC9Db25maWcucG0iOwoKCiAgICByZXR1cm4gJFNlbGY7Cn0KCgpzdWIgR2V0T3B0aW9uIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGlmICggISRQYXJhbXtXaGF0fSApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5lZWQgV2hhdCEiCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBtb2R1bGUgb3B0aW9ucwogICAgbXkgJU9wdGlvbiA9ICgKICAgICAgICBQcmVBdXRoID0+IDAsCiAgICApOwoKICAgICMgcmV0dXJuIG9wdGlvbgogICAgcmV0dXJuICRPcHRpb257ICRQYXJhbXtXaGF0fSB9Owp9CgpzdWIgQXV0aCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwogICAgCiAgICBteSAkUGFyYW1PYmplY3QgID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OldlYjo6UmVxdWVzdCcpOwogICAgCiAgICBteSAkd2FudFNhbWxSZXF1ZXN0ID0gJFBhcmFtT2JqZWN0LT5HZXRQYXJhbSggUGFyYW0gPT4gJ1dhbnRTQU1MUmVxdWVzdCcgKTsKCW15ICRzYW1sUmVzcG9uc2UgPSAkUGFyYW1PYmplY3QtPkdldFBhcmFtKCBQYXJhbSA9PiAnU0FNTFJlc3BvbnNlJyApOwogICAgCiAgICAKICAgIG15ICRjb25maWcgPSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6Q29uZmlnLT5uZXcoQ0dJLT5uZXcoKSk7CiAgICAkY29uZmlnLT57aWRwX3Nzb190YXJnZXRfdXJsfSA9ICRTZWxmLT57U1NPSWRwVXJsfTsKCSRjb25maWctPnthc3NlcnRpb25fY29uc3VtZXJfc2VydmljZV91cmx9ID0gIiRFTlZ7UkVRVUVTVF9TQ0hFTUV9Oi8vJEVOVntIVFRQX0hPU1R9LyIgLiAkU2VsZi0+e1NTT0Fzc2VydGlvbkNvbnN1bWVyVVJMfTsKCSRjb25maWctPntTU094NTA5Q2VydH0gPSAkU2VsZi0+e1NTT3g1MDlDZXJ0fTsKCQoJCiAgICBpZiggISBkZWZpbmVkICRzYW1sUmVzcG9uc2UgfHwgJHNhbWxSZXNwb25zZSBlcSAiIiApewoKCQkjIFRoaXMgcGFnZSBjYWxsIGlzIG5vdCB0cmlnZ2VyZWQgYnkgYW4gc2FtbCByZXNwb25zZS4gV2Ugd2lsbCBjcmVhdGUgYW4gc2FtbCByZXF1ZXN0IG9ubHkgaWYgaXQgd2FzIGV4cGxpY2l0ZWx5IHJlcXVlc3RlZAoJCWlmKCBkZWZpbmVkICR3YW50U2FtbFJlcXVlc3QpewoJCQlteSAkcmVxdWVzdCA9IEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpBdXRoUmVxdWVzdC0+bmV3KCRjb25maWcpOwoJCQlteSAkaWRwX3JlZGlyZWN0ID0gJHJlcXVlc3QtPmNyZWF0ZSgpLiImUmV0dXJuVVJMPSIuJGNvbmZpZy0+e2Fzc2VydGlvbl9jb25zdW1lcl9zZXJ2aWNlX3VybH07CgkJCXByaW50IENHSTo6cmVkaXJlY3QoJGlkcF9yZWRpcmVjdCk7CgkJfWVsc2V7CgkJCXJldHVybjsKCQl9CgkJCgl9ZWxzZXsKCQlteSAkcmVzcG9uc2UgPSBLZXJuZWw6OlN5c3RlbTo6QXV0aDo6U0FNTDJTUDo6UmVzcG9uc2UtPm5ldygkc2FtbFJlc3BvbnNlLCAkY29uZmlnKTsKCQkKCQlpZigkcmVzcG9uc2UtPmlzX3ZhbGlkKCkpewoJCQlyZXR1cm4gJHJlc3BvbnNlLT5nZXRfYXR0cmlidXRlKCRTZWxmLT57U1NPVXNlcklkQXR0cmlidXRlfSk7CgkJfWVsc2V7CgkJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAoJICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKCSAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJSZWNlaXZlZCBhbiBTQU1MIHJlc3BvbnNlIHdpdGggYSB3cm9uZyBzaWduYXR1cmUhIgogICAgICAgIAkpOwogICAgICAgIAoJCQlyZXR1cm47CgkJfQoJCQoJCQoJfQogICAgCiAgICAKICAgIAoJcmV0dXJuOwp9CgoxOw==</File>
        <File Location="Kernel/System/CustomerAuth/SAML2SP/AuthRequest.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpBdXRoUmVxdWVzdC5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIGh0dHBzOi8vZ2l0aHViLmNvbS9yZXN0ZW5hLW1hL290cnMtc2FtbDJzcAojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXI6OkF1dGhNb2R1bGU6OlNBTUwyU1A6OkF1dGhSZXF1ZXN0OwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwoKdXNlIERhdGVUaW1lOwp1c2UgTUlNRTo6QmFzZTY0Owp1c2UgQ29tcHJlc3M6OlpsaWI7CnVzZSBVUkk6OkVzY2FwZTsKCgpzdWIgbmV3ewoJbXkgJGNsYXNzID0gc2hpZnQ7CglteSAoICRzZXR0aW5ncyApID0gQF87IAoJCglteSAkc2VsZiA9IGJsZXNzIHsKCQlzZXR0aW5ncyA9PiAkc2V0dGluZ3MgCgl9LCAkY2xhc3M7IAoJCglyZXR1cm4gJHNlbGY7Cn0KCnN1YiBjcmVhdGV7CglteSAkc2VsZiA9IHNoaWZ0OwoJCgkKICAgIAoJbXkgJGlkID0gJHNlbGYtPmdlbmVyYXRlVW5pcXVlSUQoMjApOwoJbXkgJGlzc3VlX2luc3RhbnQgPSAkc2VsZi0+Z2V0VGltZVN0YW1wKCk7CgogICAgbXkgJHJlcXVlc3QgPSAiPHNhbWxwOkF1dGhuUmVxdWVzdCB4bWxuczpzYW1scD1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbFwiIElEPVwiJGlkXCIgVmVyc2lvbj1cIjIuMFwiIElzc3VlSW5zdGFudD1cIiRpc3N1ZV9pbnN0YW50XCIgUHJvdG9jb2xCaW5kaW5nPVwidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmJpbmRpbmdzOkhUVFAtUE9TVFwiIEFzc2VydGlvbkNvbnN1bWVyU2VydmljZVVSTD1cIiIuJHNlbGYtPntzZXR0aW5nc30tPnthc3NlcnRpb25fY29uc3VtZXJfc2VydmljZV91cmx9LiJcIj4iLgogICAgICAgICAgICAiPHNhbWw6SXNzdWVyIHhtbG5zOnNhbWw9XCJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uXCI+Ii4kc2VsZi0+e3NldHRpbmdzfS0+e2lzc3Vlcn0uIjwvc2FtbDpJc3N1ZXI+XG4iLgogICAgICAgICAgICAiPHNhbWxwOk5hbWVJRFBvbGljeSB4bWxuczpzYW1scD1cInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbFwiIEZvcm1hdD1cIiRzZWxmLT57c2V0dGluZ3N9LT57bmFtZV9pZGVudGlmaWVyX2Zvcm1hdH1cIiBBbGxvd0NyZWF0ZT1cInRydWVcIj48L3NhbWxwOk5hbWVJRFBvbGljeT5cbiIuCiAgICAgICAgICAgICI8L3NhbWxwOkF1dGhuUmVxdWVzdD4iOwoJCgkKCW15ICRkZWZsYXRlZF9yZXF1ZXN0ICA9IGNvbXByZXNzKCRyZXF1ZXN0KTsKCSRkZWZsYXRlZF9yZXF1ZXN0ID0gc3Vic3RyKCRkZWZsYXRlZF9yZXF1ZXN0LCAyLCBsZW5ndGgoJGRlZmxhdGVkX3JlcXVlc3QpLTQpOyAjIHBocCBpbmZsYXRlIGRvZXMgbm90IGxpa2UgZmlyc3QgMiBieXRlcyBhbmQgbGFzdCA0dGggPyE/CgkKCQoJbXkgJGJhc2U2NF9yZXF1ZXN0ID0gZW5jb2RlX2Jhc2U2NCgkZGVmbGF0ZWRfcmVxdWVzdCk7CgkKCW15ICRlbmNvZGVkX3JlcXVlc3QgPSB1cmlfZXNjYXBlKCRiYXNlNjRfcmVxdWVzdCk7CgkKICAgIHJldHVybiAkc2VsZi0+e3NldHRpbmdzfS0+e2lkcF9zc29fdGFyZ2V0X3VybH0uIj9TQU1MUmVxdWVzdD0iLiRlbmNvZGVkX3JlcXVlc3Q7Cn0KCgpzdWIgZ2VuZXJhdGVVbmlxdWVJRHsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRsZW5ndGggKSA9IEBfOwoJCglteSAkY2hhcnMgPSAiYWJjZGVmMDEyMzQ1Njc4OSI7CiAgICBteSAkY2hhcnNfbGVuID0gbGVuZ3RoKCRjaGFycyk7CiAgICBteSAkdW5pcXVlSUQgPSAiIjsKICAgIGZvciAobXkgJGkgPSAwOyAkaSA8ICRsZW5ndGg7ICRpKyspewogICAgCSR1bmlxdWVJRCAuPSBzdWJzdHIoJGNoYXJzLHJhbmQoJGNoYXJzX2xlbiksMSk7CiAgICB9CiAgICByZXR1cm4gIl8iLiR1bmlxdWVJRDsKfQoKCnN1YiBnZXRUaW1lU3RhbXB7CglteSAkc2VsZiA9IHNoaWZ0OwoJCiAgICBteSAkZHQgPSBEYXRlVGltZS0+bm93KCk7CiAgICByZXR1cm4gJGR0LT5zdHJmdGltZSgiJVktJW0tJWRUJUg6JU06JVNaIik7Cn0KCjE7</File>
        <File Location="Kernel/System/CustomerAuth/SAML2SP/Config.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpDb25maWcucG0gLSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKIyBDb3B5cmlnaHQgKEMpICgyMDE2KSAoTWF4aW1lIEFwcG9sb25pYSkgKG1heGltZS5hcHBvbG9uaWFAcmVzdGVuYS5sdSkKIyBodHRwczovL2dpdGh1Yi5jb20vcmVzdGVuYS1tYS9vdHJzLXNhbWwyc3AKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQuCiMgLS0KCnBhY2thZ2UgS2VybmVsOjpTeXN0ZW06OkN1c3RvbWVyOjpBdXRoTW9kdWxlOjpTQU1MMlNQOjpDb25maWc7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7CgojIFRoaXMgY2xhc3MgaXMgYSBzdHJ1Y3R1cmUgd2hpY2ggaG9sZHMgdGhlIHNldHRpbmdzIGRlZmluZWQgaW4gdGhlIG90cnMgY29uZmlnIGZpbGUKIyBEbyBub3QgZmlsbCB5b3VyIHNldHRpbmdzIGhlcmUgIQoKc3ViIG5ld3sKCW15ICRjbGFzcyA9IHNoaWZ0OwoJbXkgKCAkY2dpICkgPSBAXzsgCgkKCW15ICRzZWxmID0gYmxlc3MgewoJCWlkcF9zc29fdGFyZ2V0X3VybCA9PiAiIiwKCQl4NTA5Y2VydGlmaWNhdGUgPT4gIiIsCgkJYXNzZXJ0aW9uX2NvbnN1bWVyX3NlcnZpY2VfdXJsID0+ICRjZ2ktPnVybCgpLAoJCWlzc3VlciA9PiAiJEVOVntSRVFVRVNUX1NDSEVNRX06Ly8kRU5We0hUVFBfSE9TVH0vIiwKCQluYW1lX2lkZW50aWZpZXJfZm9ybWF0ID0+ICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoxLjE6bmFtZWlkLWZvcm1hdDplbWFpbEFkZHJlc3MiCgl9LCAkY2xhc3M7IAoJCglyZXR1cm4gJHNlbGY7Cn0KCjE7</File>
        <File Location="Kernel/System/CustomerAuth/SAML2SP/Response.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbDo6U3lzdGVtOjpBdXRoOjpTQU1MMlNQOjpSZXNwb25zZS5wbSAtIGF1dGhlbnRpY2F0aW9uIG1vZHVsZQojIENvcHlyaWdodCAoQykgKDIwMTYpIChNYXhpbWUgQXBwb2xvbmlhKSAobWF4aW1lLmFwcG9sb25pYUByZXN0ZW5hLmx1KQojIGh0dHBzOi8vZ2l0aHViLmNvbS9yZXN0ZW5hLW1hL290cnMtc2FtbDJzcAojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6Q3VzdG9tZXI6OkF1dGhNb2R1bGU6OlNBTUwyU1A6OlJlc3BvbnNlOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwoKdXNlIERhdGE6OkR1bXBlcjsKdXNlIERhdGVUaW1lOwp1c2UgRGF0ZVRpbWU6OkZvcm1hdDo6RGF0ZVBhcnNlOwp1c2UgTUlNRTo6QmFzZTY0Owp1c2UgWE1MOjpMaWJYTUw7CnVzZSBEaWdlc3Q6OlNIQSBxdyhzaGExX2Jhc2U2NCBzaGEyNTZfYmFzZTY0IHNoYTUxMl9iYXNlNjQpOwp1c2UgQ3J5cHQ6Ok9wZW5TU0w6OlJTQTsKdXNlIENyeXB0OjpPcGVuU1NMOjpYNTA5OwoKc3ViIG5ld3sKCW15ICRjbGFzcyA9IHNoaWZ0OwoJbXkgKCAkcmF3X3Jlc3BvbnNlLCAkc2V0dGluZ3MgKSA9IEBfOyAKCQoJbXkgJHNlbGYgPSBibGVzcyB7CgkJcmF3X3Jlc3BvbnNlID0+ICRyYXdfcmVzcG9uc2UsCgkJc2V0dGluZ3MgPT4gJHNldHRpbmdzLAoJCXhtbF9hc19kb20gPT4gIiIsCgkJc2lnbmF0dXJlX25vZGUgPT4gIiIsCgkJc2lnbmVkSW5mbyA9PiAiIiwKCQl2YWxpZGF0ZWRfbm9kZXMgPT4gdW5kZWYsCgkJc2lnbmVkX2luZm8gPT4gIiIsCgkJa2V5X3NpZ25fYWxnbyA9PiAiIgoJfSwgJGNsYXNzOyAKCQoJJHNlbGYtPmRlY29kZSgpOwoJCglyZXR1cm4gJHNlbGY7Cn0KCgpzdWIgZGVjb2RlewoJbXkgJHNlbGYgPSBzaGlmdDsKCQoJJHNlbGYtPnt4bWxfYXNfc3RyaW5nfSA9IGRlY29kZV9iYXNlNjQoJHNlbGYtPntyYXdfcmVzcG9uc2V9KTsKCQoJbXkgJHBhcnNlciA9IFhNTDo6TGliWE1MLT5uZXcoKTsKCSRzZWxmLT57eG1sX2FzX2RvbX0gPSAkcGFyc2VyLT5wYXJzZV9zdHJpbmcoJHNlbGYtPnt4bWxfYXNfc3RyaW5nfSk7Cn0KCnN1YiBpc192YWxpZHsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCWlmKCEkc2VsZi0+dmFsaWRhdGVOdW1Bc3NlcnRpb25zKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBubyBvciBtb3JlIHRoYW4gb25lIHNhbWwgYXNzZXJ0aW9uIGluIHRoZSByZXNwb25zZSwgbmVlZCBvbmx5IG9uZSIpOwoJCXJldHVybjsKCX0KCQoJaWYoISRzZWxmLT52YWxpZGF0ZVRpbWVzdGFtcHMoKSl7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IHRpbWVzdGFtcHMgZG8gbm90IG1hdGNoIik7CgkJcmV0dXJuOwoJfQoJCglpZighJHNlbGYtPnZhbGlkYXRlVGltZXN0YW1wcygpKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogdGltZXN0YW1wcyBkbyBub3QgbWF0Y2giKTsKCQlyZXR1cm47Cgl9CgkKCQoJbXkgJHNpZ25hdHVyZSA9ICRzZWxmLT5nZXRfc2lnbmF0dXJlKCk7CglpZighJHNpZ25hdHVyZSl7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUw6IG5vIGRpZ2l0YWwgc2lnbmF0dXJlIGZvdW5kIik7CgkJcmV0dXJuOwoJfQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJERUJVRzogIi4kc2lnbmF0dXJlKTsKCQoJJHNlbGYtPntzaWduZWRfaW5mb30gPSAkc2VsZi0+Y2Fub25pY2FsaXplU2lnbmVkSW5mbygpOwoJCglpZighJHNlbGYtPnZhbGlkYXRlX3JlZmVyZW5jZSgpKXsKCQkkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlICA9PiAiU0FNTDogZGlnZXN0IGlzIG5vdCB2YWxpZCBvciB3YXMgbm90IGZvdW5kIik7CgkJcmV0dXJuOwoJfQoJCglteSAkb2JqS2V5ID0gJHNlbGYtPmxvY2F0ZUtleSgpOwogICAgaWYoISAkb2JqS2V5ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBXZSBoYXZlIG5vIGlkZWEgYWJvdXQgdGhlIGtleSIpOwogICAgICAgIHJldHVybjsKICAgIH0KCQoJaWYoISRzZWxmLT52ZXJpZnlfc2lnbmF0dXJlKCkpewoJCSRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJTQU1MOiBTaWduYXR1cmUgdmVyaWZpY2F0aW9uIGZhaWxlZCAhIik7CgkJcmV0dXJuOwkJCgl9CgkKCXJldHVybiAxOwp9CgoKc3ViIGdldF9zaWduYXR1cmV7CglteSAkc2VsZiA9IHNoaWZ0OwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPnt4bWxfYXNfZG9tfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNlY2RzaWciLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIpOwoJbXkgJHF1ZXJ5ID0gIi4vL3NlY2RzaWc6U2lnbmF0dXJlIjsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7Cgkkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSA9ICRub2Rlc1swXTsgCglyZXR1cm4gJG5vZGVzWzBdOwp9CgpzdWIgY2Fub25pY2FsaXplU2lnbmVkSW5mbygpIHsKCW15ICRzZWxmID0gc2hpZnQ7CgkKICAgIG15ICRjYW5vbmljYWxtZXRob2QgPSB1bmRlZjsKICAgIAogICAgbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KTsKICAgICR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CiAgICBteSAkcXVlcnkgPSAiLi9zZWNkc2lnOlNpZ25lZEluZm8iOwogICAgbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKICAgIG15ICRzaWduSW5mb05vZGUgPSAkbm9kZXNbMF07CiAgICBpZiAoJHNpZ25JbmZvTm9kZSkgewogICAgCW15ICR4cGF0aDIgPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNpZ25JbmZvTm9kZSk7CgkgICAgJHhwYXRoMi0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CgkgICAgbXkgJHF1ZXJ5MiA9ICIuL3NlY2RzaWc6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCI7CgkgICAgbXkgQG5vZGVzMiA9ICR4cGF0aDItPmZpbmRub2RlcygkcXVlcnkyKTsKICAgICAgICBteSAkY2Fub25Ob2RlID0gJG5vZGVzMlswXTsgIAogICAgICAgIG15IEBhdHRyID0gJGNhbm9uTm9kZS0+YXR0cmlidXRlcygpOwogICAgICAgIG15ICRjYW5vbmljYWxtZXRob2Q7CiAgICAgICAgZm9yKG15ICRqPTA7ICRqIDwgc2NhbGFyKEBhdHRyKSA7ICRqKyspewogICAgCQlpZigkYXR0clskal0tPm5vZGVOYW1lIGVxICJBbGdvcml0aG0iKXsKICAgIAkJCSRjYW5vbmljYWxtZXRob2QgPSAkYXR0clskal0tPnZhbHVlOwkKICAgIAkJfQogICAgICAgIH0KICAgICAgICAkc2VsZi0+e3NpZ25lZEluZm99ID0gJHNlbGYtPmNhbm9uaWNhbGl6ZURhdGEoJHNpZ25JbmZvTm9kZSwgJGNhbm9uaWNhbG1ldGhvZCk7CiAgICAgICAgIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgID0+ICJERUJVRzogIi5EdW1wZXIoJHNlbGYtPntzaWduZWRJbmZvfSkpOwogICAgICAgIHJldHVybiAkc2VsZi0+e3NpZ25lZEluZm99OwogICAgfQogICAgcmV0dXJuOwp9CgpzdWIgY2Fub25pY2FsaXplRGF0YXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRub2RlLCAkY2Fub25pY2FsbWV0aG9kICkgPSBAXzsgCgkKCW15ICRleGNsdXNpdmUgPSAwOwogICAgbXkgJHdpdGhDb21tZW50cyA9IDA7CiAgICBpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUiKSB7ICAgIAogICAgICAgICRleGNsdXNpdmUgPSAwOwogICAgICAgICR3aXRoQ29tbWVudHMgPSAwOwogICAgfQogICAgCiAgICBpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMS9SRUMteG1sLWMxNG4tMjAwMTAzMTUjV2l0aENvbW1lbnRzIikgewogICAgICAgICR3aXRoQ29tbWVudHMgPSAxOwogICAgfQogICAgCiAgICBpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIikgewogICAgICAgICRleGNsdXNpdmUgPSAxOwogICAgfQogICAgCiAgICBpZiAoJGNhbm9uaWNhbG1ldGhvZCBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jV2l0aENvbW1lbnRzIikgewogICAgICAgICRleGNsdXNpdmUgPSAxOwogICAgICAgICR3aXRoQ29tbWVudHMgPSAxOwogICAgfQogICAgCiAgICBpZigkZXhjbHVzaXZlKXsKICAgIAlyZXR1cm4gJG5vZGUtPnRvU3RyaW5nRUMxNE4oJHdpdGhDb21tZW50cyk7CiAgICB9ZWxzZXsKICAgIAlyZXR1cm4gJG5vZGUtPnRvU3RyaW5nQzE0Tigkd2l0aENvbW1lbnRzKQogICAgfQogICAgCiAgICByZXR1cm47Cn0KCnN1YiB2YWxpZGF0ZV9yZWZlcmVuY2V7CglteSAkc2VsZiA9IHNoaWZ0OwoKCgkKICAgIGlmICghJHNlbGYtPnt4bWxfYXNfZG9tfS0+aXNTYW1lTm9kZSgkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSkpIHsKICAgICAgICAkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfS0+cGFyZW50Tm9kZS0+cmVtb3ZlQ2hpbGQoJHNlbGYtPntzaWduYXR1cmVfbm9kZX0pOwogICAgfQoKCQoJbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57c2lnbmF0dXJlX25vZGV9KTsKICAgICR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CiAgICBteSAkcXVlcnkgPSAiLi9zZWNkc2lnOlNpZ25lZEluZm8vc2VjZHNpZzpSZWZlcmVuY2UiOwogICAgbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKICAgIGlmKHNjYWxhcihAbm9kZXMpPT0wKXsKICAgIAlyZXR1cm47CiAgICB9CiAgICAKICAgICRzZWxmLT57dmFsaWRhdGVkX25vZGVzfSA9ICgpOwogICAgIAogICAgZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEBub2Rlcyk7ICRpKyspIHsKICAgIAlpZighJHNlbGYtPnByb2Nlc3NSZWZOb2RlKCRub2Rlc1skaV0pKXsKICAgIAkJJHNlbGYtPnt2YWxpZGF0ZWRfbm9kZXN9ID0gKCk7CiAgICAJCXJldHVybjsJCQogICAgCX0KICAgIH0KICAgIAogICAgcmV0dXJuIDE7Cgp9CgpzdWIgcHJvY2Vzc1JlZk5vZGV7CglteSAkc2VsZiA9IHNoaWZ0OwoJbXkgKCAkcmVmX25vZGUgKSA9IEBfOwoJCgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUwgREVCVUc6ICIuICRyZWZfbm9kZSk7CglteSBAYXR0ciA9ICRyZWZfbm9kZS0+YXR0cmlidXRlcygpOwogICAgbXkgJG5vZGVfaWQgPSAiIjsKICAgIGZvcihteSAkaj0wOyAkaiA8IHNjYWxhcihAYXR0cikgOyAkaisrKXsKICAgIAlpZigkYXR0clskal0tPm5vZGVOYW1lIGVxICJVUkkiKXsKICAgIAkJJG5vZGVfaWQgPSAkYXR0clskal0tPnZhbHVlOwogICAgCQlpZighKHN1YnN0cigkbm9kZV9pZCwgMCwgMSkgZXEgIiMiKSl7CiAgICAJCQkjIGV4dGVybmFsIHVybCBub3Qgc3VwcG9ydGVkCiAgICAJCQlyZXR1cm47CiAgICAJCX0KICAgIAkJJG5vZGVfaWQgPSBzdWJzdHIoJG5vZGVfaWQsIDEsIGxlbmd0aCgkbm9kZV9pZCkpOwogICAgCQkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSAgPT4gIlNBTUwgREVCVUc6ICIuICRub2RlX2lkKTsKICAgIAl9CiAgICB9CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3htbF9hc19kb219KTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2FtbHAiLCAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIik7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWwiLCAidXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIpOwoJbXkgJHF1ZXJ5ID0gJy8vKltASUQ9IicuICRub2RlX2lkIC4nIl0nOwoJbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiAiLiBEdW1wZXIoJG5vZGVzWzBdKSk7CgkKCW15ICRkYXRhT2JqZWN0ID0gJG5vZGVzWzBdOwoJCglpZighJHNlbGYtPnZhbGlkYXRlRGlnZXN0KCRyZWZfbm9kZSwgJGRhdGFPYmplY3QpKXsKCQlyZXR1cm47Cgl9CgkKCSRzZWxmLT57dmFsaWRhdGVkX25vZGVzfXskbm9kZV9pZH0gPSAkZGF0YU9iamVjdDsgCgkKCXJldHVybiAxOwoJCn0KCgoKCnN1YiB2YWxpZGF0ZURpZ2VzdCgpewoJbXkgJHNlbGYgPSBzaGlmdDsKCW15ICggJHJlZl9ub2RlLCAkZGF0YV9vYmplY3QgKSA9IEBfOwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHJlZl9ub2RlKTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2VjZHNpZyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIik7CglteSAkcXVlcnkgPSAnLi9zZWNkc2lnOkRpZ2VzdE1ldGhvZC9AQWxnb3JpdGhtJzsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CglteSAkZGlnZXN0QWxnb3JpdGhtID0gJG5vZGVzWzBdLT50ZXh0Q29udGVudDsKCQoJbXkgJGRhdGEgPSAkc2VsZi0+cHJvY2Vzc1RyYW5zZm9ybXMoJHJlZl9ub2RlLCAkZGF0YV9vYmplY3QpOwoJbXkgJGNhbGN1bGF0ZWREaWdWYWx1ZSA9ICRzZWxmLT5jYWxjdWxhdGVEaWdlc3QoJGRpZ2VzdEFsZ29yaXRobSwgJGRhdGEpOwogICAgCiAgICAjIHJlbW92ZSA9IHBhZGRuZyBjaGFyYWN0ZXJzCiAgICAkY2FsY3VsYXRlZERpZ1ZhbHVlID1+IHMvXG4vL2c7CiAgICAKICAgIG15ICRxdWVyeTIgPSAiLi9zZWNkc2lnOkRpZ2VzdFZhbHVlIjsKICAgIG15IEBub2RlczIgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkyLCAkcmVmX25vZGUpOwogICAgbXkgJGRpZ2VzdFZhbHVlID0gJG5vZGVzMlswXS0+dGV4dENvbnRlbnQ7CiAgICAKICAgICMgcmVtb3ZlID0gcGFkZG5nIGNoYXJhY3RlcnMKICAgICRkaWdlc3RWYWx1ZSA9fiBzL1w9Ly9nOwogICAgCgkjJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiLS0tIi4gJGRhdGEgLiAiLS0tIik7CgkKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiB2YWwgaGFzaCBpcyAiLiAkY2FsY3VsYXRlZERpZ1ZhbHVlKTsKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiB4bWwgaGFzaCBpcyAiLiAkZGlnZXN0VmFsdWUpOwogICAgCgkKCWlmKCRjYWxjdWxhdGVkRGlnVmFsdWUgIGVxICRkaWdlc3RWYWx1ZSl7CgkJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IGRpZ2VzdCBhcmUgbWF0Y2hpbmciKTsKCQlyZXR1cm4gMTsKCX0JCgkKCSMkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZyhQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICJTQU1MIERFQlVHOiBkaWdlc3QgYXJlIG5vdCBtYXRjaGluZyIpOwoJcmV0dXJuOwp9CgpzdWIgcHJvY2Vzc1RyYW5zZm9ybXMoKXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRyZWZfbm9kZSwgJGRhdGFfb2JqZWN0ICkgPSBAXzsKCQoJcmV0dXJuICRzZWxmLT5jYW5vbmljYWxpemVEYXRhKCRkYXRhX29iamVjdCwgImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIpOwoJCn0KCnN1YiBjYWxjdWxhdGVEaWdlc3QoKXsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRkaWdlc3RBbGdvcml0aG0sICRkYXRhICkgPSBAXzsKCQoJaWYoJGRpZ2VzdEFsZ29yaXRobSBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiKXsKCQlyZXR1cm4gc2hhMV9iYXNlNjQoJGRhdGEpOwoJfQoJCglpZigkZGlnZXN0QWxnb3JpdGhtIGVxICJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNzaGEyNTYiKXsKCQlyZXR1cm4gc2hhMjU2X2Jhc2U2NCgkZGF0YSk7Cgl9CgkKCWlmKCRkaWdlc3RBbGdvcml0aG0gZXEgImh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTUxMiIpewoJCXJldHVybiBzaGE1MTJfYmFzZTY0KCRkYXRhKTsKCX0KCQoJaWYoJGRpZ2VzdEFsZ29yaXRobSBlcSAiaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjcmlwZW1kMTYwIil7CgkJJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAiU0FNTCBlcnJvcjogcmlwZW1kMTYwIGRpZ2VzdCBub3Qgc3VwcG9ydGVkIik7CgkJcmV0dXJuOwoJfQoJCglyZXR1cm47Cn0KCgpzdWIgbG9jYXRlS2V5KCl7CglteSAkc2VsZiA9IHNoaWZ0OwoJCgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNlY2RzaWciLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIpOwoJbXkgJHF1ZXJ5ID0gJy4vc2VjZHNpZzpTaWduZWRJbmZvL3NlY2RzaWc6U2lnbmF0dXJlTWV0aG9kL0BBbGdvcml0aG0nOwoJbXkgQG5vZGVzID0gJHhwYXRoLT5maW5kbm9kZXMoJHF1ZXJ5KTsKCQoJCglteSAkYWxnb3JpdGhtID0gJG5vZGVzWzBdLT50ZXh0Q29udGVudDsKICAgIGlmICgkYWxnb3JpdGhtKSB7CiAgICAJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6ICIuJGFsZ29yaXRobSk7CiAgICAJJHNlbGYtPntrZXlfc2lnbl9hbGdvfSA9ICRhbGdvcml0aG07CiAgICAgICAgIyAkb2JqS2V5ID0gbmV3IFhNTFNlY3VyaXR5S2V5KCRhbGdvcml0aG0sIGFycmF5KCd0eXBlJz0+J3B1YmxpYycpKTsKICAgICAgICAjcmV0dXJuICRvYmpLZXk7CiAgICB9CgkKfQoKc3ViIHZlcmlmeV9zaWduYXR1cmUoKXsKCW15ICRzZWxmID0gc2hpZnQ7CgkKCW15ICR4cGF0aCA9IFhNTDo6TGliWE1MOjpYUGF0aENvbnRleHQtPm5ldygkc2VsZi0+e3NpZ25hdHVyZV9ub2RlfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNlY2RzaWciLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyIpOwoJbXkgJHF1ZXJ5ID0gJy4vc2VjZHNpZzpTaWduYXR1cmVWYWx1ZSc7CglteSBAbm9kZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwoJbXkgJHNpZ1ZhbHVlID0gZGVjb2RlX2Jhc2U2NCgkbm9kZXNbMF0tPnRleHRDb250ZW50KTsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6ICIuICRzZWxmLT57c2V0dGluZ3N9e1NTT3g1MDlDZXJ0fSk7CgkKCW15ICR4NTA5ID0gQ3J5cHQ6Ok9wZW5TU0w6Olg1MDktPm5ld19mcm9tX3N0cmluZygkc2VsZi0+e3NldHRpbmdzfXtTU094NTA5Q2VydH0sIENyeXB0OjpPcGVuU1NMOjpYNTA5OjpGT1JNQVRfUEVNKTsKCW15ICRwdWJrZXkgPSBDcnlwdDo6T3BlblNTTDo6UlNBLT5uZXdfcHVibGljX2tleSgkeDUwOS0+cHVia2V5KCkpOwoJJHB1YmtleS0+dXNlX3NoYTFfaGFzaCgpOwoKCW15ICR2YWxpZCA9ICRwdWJrZXktPnZlcmlmeSgkc2VsZi0+e3NpZ25lZF9pbmZvfSwgJHNpZ1ZhbHVlKTsKCQoJIyRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gIlNBTUwgREVCVUc6IFNpZ25hdHVyZSBpcyAiLiR2YWxpZCk7CgkKCXJldHVybiAkdmFsaWQ7CgkKfQoKc3ViIHZhbGlkYXRlTnVtQXNzZXJ0aW9ucygpewoJbXkgJHNlbGYgPSBzaGlmdDsKICAgIAogICAgbXkgQGFzc2VydGlvbk5vZGVzID0gJHNlbGYtPnt4bWxfYXNfZG9tfS0+Z2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NhbWw6QXNzZXJ0aW9uJyk7CiAgICByZXR1cm4gKHNjYWxhcihAYXNzZXJ0aW9uTm9kZXMpID09IDEpOwp9CgoKc3ViIHZhbGlkYXRlVGltZXN0YW1wcygpewoJbXkgJHNlbGYgPSBzaGlmdDsKICAgIAogICAgbXkgQHRpbWVzdGFtcE5vZGVzID0gJHNlbGYtPnt4bWxfYXNfZG9tfS0+Z2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NhbWw6Q29uZGl0aW9ucycpOwogICAgZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEB0aW1lc3RhbXBOb2RlcykgOyAkaSsrKXsKICAgIAlteSBAYXR0ciA9ICR0aW1lc3RhbXBOb2Rlc1skaV0tPmF0dHJpYnV0ZXMoKTsKICAgIAkKICAgIAlmb3IobXkgJGo9MDsgJGogPCBzY2FsYXIoQGF0dHIpIDsgJGorKyl7CiAgICAJCWlmKAogICAgCQkJJGF0dHJbJGpdLT5ub2RlTmFtZSBlcSAiTm90QmVmb3JlIiAmJiAKICAgIAkJCShEYXRlVGltZTo6Rm9ybWF0OjpEYXRlUGFyc2UtPnBhcnNlX2RhdGV0aW1lKCRhdHRyWyRqXS0+dmFsdWUpIC0gRGF0ZVRpbWUtPm5vdygpKS0+aXNfcG9zaXRpdmUoKSAgIAogICAgCQkpewogICAgCQkJcmV0dXJuOwogICAgCQl9CiAgICAJCWlmKAogICAgCQkJJGF0dHJbJGpdLT5ub2RlTmFtZSBlcSAiTm90T25PckFmdGVyIiAmJiAKICAgIAkJCSEoRGF0ZVRpbWU6OkZvcm1hdDo6RGF0ZVBhcnNlLT5wYXJzZV9kYXRldGltZSgkYXR0clskal0tPnZhbHVlKSAtIERhdGVUaW1lLT5ub3coKSktPmlzX3Bvc2l0aXZlKCkgICAKICAgIAkJKXsKICAgIAkJCXJldHVybjsKICAgIAkJfQogICAgCX0KICAgIH0KICAgIHJldHVybiAxOwp9CgoKc3ViIGdldF9uYW1laWR7CglteSAkc2VsZiA9IHNoaWZ0OwoJCglteSAkeHBhdGggPSBYTUw6OkxpYlhNTDo6WFBhdGhDb250ZXh0LT5uZXcoJHNlbGYtPnt4bWxfYXNfZG9tfSk7CgkkeHBhdGgtPnJlZ2lzdGVyTnMoInNhbWxwIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpwcm90b2NvbCIpOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1sIiwgInVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iKTsKCW15ICRxdWVyeSA9ICIvc2FtbHA6UmVzcG9uc2Uvc2FtbDpBc3NlcnRpb24vc2FtbDpTdWJqZWN0L3NhbWw6TmFtZUlEIjsKCW15IEBub2RlcyA9ICR4cGF0aC0+ZmluZG5vZGVzKCRxdWVyeSk7CgkKCXJldHVybiAkbm9kZXNbMF0tPnRvU3RyaW5nKCk7Cn0KCgpzdWIgZ2V0X2F0dHJpYnV0ZSgpIHsKCW15ICRzZWxmID0gc2hpZnQ7CglteSAoICRuYW1lICkgPSBAXzsKCQogICAgbXkgJHhwYXRoID0gWE1MOjpMaWJYTUw6OlhQYXRoQ29udGV4dC0+bmV3KCRzZWxmLT57eG1sX2FzX2RvbX0pOwoJJHhwYXRoLT5yZWdpc3Rlck5zKCJzYW1scCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiKTsKCSR4cGF0aC0+cmVnaXN0ZXJOcygic2FtbCIsICJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIik7CglteSAkcXVlcnkgPSAnL3NhbWxwOlJlc3BvbnNlL3NhbWw6QXNzZXJ0aW9uL3NhbWw6QXR0cmlidXRlU3RhdGVtZW50L3NhbWw6QXR0cmlidXRlW0BOYW1lPSInLiAkbmFtZSAuJyJdL3NhbWw6QXR0cmlidXRlVmFsdWUnOwoJbXkgQGVudHJpZXMgPSAkeHBhdGgtPmZpbmRub2RlcygkcXVlcnkpOwogICAgCiAgICAKICAgIGlmKHNjYWxhcihAZW50cmllcyk+IDApewogICAgICAgIGlmKHNjYWxhcihAZW50cmllcykgPiAxKSB7CiAgICAgICAgICAgIG15IEByZXR1cm4gPSAoKTsKICAgICAgICAgICAgZm9yKG15ICRpPTA7ICRpIDwgc2NhbGFyKEBlbnRyaWVzKTsgJGkrKykgewogICAgICAgICAgICAgICAgcHVzaChAcmV0dXJuLCAkZW50cmllc1skaV0tPnRleHRDb250ZW50KCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBAcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAkZW50cmllc1swXS0+dGV4dENvbnRlbnQoKTsKICAgICAgICAgICAgI3JldHVybiAibWFwcG9sb25pYSI7CiAgICAgICAgfQogICAgfWVsc2V7CiAgICAgICAgcmV0dXJuIDsKICAgIH0KfQoKMTs=</File>
    </Filelist>
</otrs_package>